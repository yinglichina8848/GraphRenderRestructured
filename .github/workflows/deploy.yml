name: 🚀 构建并发布文档到 GitHub Pages

on:
  workflow_dispatch:  # 手动触发
  push:
    branches: [ main ]  # 可修改为你的主分支

jobs:
  build-and-publish:
    runs-on: ubuntu-latest

    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # GitHub 自动注入，无需配置
      JAVA_HOME: /usr/lib/jvm/java-17-openjdk-amd64

    steps:
      - name: 🧾 检出仓库
        uses: actions/checkout@v4

      - name: ☕️ 设置 Java 17 环境
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: 17

      - name: 🧰 安装依赖工具
        run: |
          sudo apt-get update
          sudo apt-get install -y doxygen graphviz pandoc

      - name: 🏗️ 运行 publish.sh 脚本
        run: |
          chmod +x publish.sh
          ./publish.sh

