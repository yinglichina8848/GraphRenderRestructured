name: AIè‡ªåŠ¨ä¿®å¤ä¸å‘å¸ƒ

on:
  schedule:
    - cron: '0 * * * *'  # æ¯å°æ—¶
  push:
    branches: [main]

jobs:
  build-and-ai-fix:
    runs-on: ubuntu-latest

    steps:
      - name: â¬‡ï¸ æ£€å‡ºä»“åº“
        uses: actions/checkout@v4

      - name: âš™ï¸ å®‰è£… Java å’Œ Node.js
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸ§  å®‰è£… aider CLIï¼ˆæˆ–ä½ è‡ªå·±çš„ AI å·¥å…·ï¼‰
        run: |
          pip install aider-cli  # å¦‚æœä½ ç”¨çš„æ˜¯ pip å®‰è£…
          aider --version || echo "éªŒè¯ Aider æ˜¯å¦å®‰è£…æˆåŠŸ"

      - name: ğŸ¤– å¯åŠ¨ AI è‡ªåŠ¨æ”¹è¿› + æ„å»º + å‘å¸ƒ
        run: |
          chmod +x ai_improve.sh
          ./aiimprove.sh

      - name: ğŸ¤– å¯åŠ¨ AI è‡ªåŠ¨ä¿®å¤ + æ„å»º + å‘å¸ƒ
        run: |
          chmod +x aifix.sh
          ./aiimprove.sh

      - name: ğŸ“¦ ä¸Šä¼  AI æŠ¥å‘Š
        uses: actions/upload-artifact@v3
        with:
          name: ai-fix-report
          path: doc/ai_fix_suggestions.md

